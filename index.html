<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A beautiful web-based clock with ring animations and comet trail effects">
    <meta name="theme-color" content="#667eea">

    <title>Ring Time Clock</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ring Clock">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512.png">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Fullscreen Button -->
    <button class="fullscreen-btn" id="fullscreenBtn" aria-label="Toggle fullscreen">
        ‚õ∂
    </button>

    <!-- Alarm Button -->
    <button class="alarm-btn" id="alarmBtn" aria-label="Open alarm">
        ‚è∞
    </button>

    <!-- Settings Button -->
    <button class="settings-btn" id="settingsBtn" aria-label="Open settings">
        ‚öô
    </button>

    <!-- Fullscreen Hint -->
    <div class="fullscreen-hint" id="fullscreenHint">
        <span class="hint-text">Press <kbd>ESC</kbd> to exit fullscreen</span>
    </div>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal" role="dialog" aria-labelledby="settingsTitle" aria-modal="true">
        <div class="settings-panel">
            <div class="settings-header">
                <h2 class="settings-title" id="settingsTitle">Settings</h2>
                <button class="close-btn" id="closeBtn" aria-label="Close settings">√ó</button>
            </div>

            <div class="settings-section">
                <label class="settings-label">Color Theme</label>
                <div class="theme-grid" role="radiogroup" aria-label="Color theme selection">
                    <div class="theme-option active" data-theme="classic" role="radio" aria-checked="true" tabindex="0">
                        <div class="theme-preview">
                            <div class="theme-color" style="background: #667eea;"></div>
                            <div class="theme-color" style="background: #f093fb;"></div>
                            <div class="theme-color" style="background: #4facfe;"></div>
                            <div class="theme-color" style="background: #43e97b;"></div>
                        </div>
                        <div class="theme-name">Classic</div>
                    </div>

                    <div class="theme-option" data-theme="warm" role="radio" aria-checked="false" tabindex="0">
                        <div class="theme-preview">
                            <div class="theme-color" style="background: #ff6b6b;"></div>
                            <div class="theme-color" style="background: #ffa600;"></div>
                            <div class="theme-color" style="background: #ff8c42;"></div>
                            <div class="theme-color" style="background: #ffd93d;"></div>
                        </div>
                        <div class="theme-name">Warm Sunset</div>
                    </div>

                    <div class="theme-option" data-theme="ocean" role="radio" aria-checked="false" tabindex="0">
                        <div class="theme-preview">
                            <div class="theme-color" style="background: #1e3a8a;"></div>
                            <div class="theme-color" style="background: #0ea5e9;"></div>
                            <div class="theme-color" style="background: #06b6d4;"></div>
                            <div class="theme-color" style="background: #67e8f9;"></div>
                        </div>
                        <div class="theme-name">Ocean Breeze</div>
                    </div>

                    <div class="theme-option" data-theme="neon" role="radio" aria-checked="false" tabindex="0">
                        <div class="theme-preview">
                            <div class="theme-color" style="background: #ff00ff;"></div>
                            <div class="theme-color" style="background: #00ffff;"></div>
                            <div class="theme-color" style="background: #ff00aa;"></div>
                            <div class="theme-color" style="background: #00ff00;"></div>
                        </div>
                        <div class="theme-name">Neon Night</div>
                    </div>

                    <div class="theme-option" data-theme="pastel" role="radio" aria-checked="false" tabindex="0">
                        <div class="theme-preview">
                            <div class="theme-color" style="background: #ffc6ff;"></div>
                            <div class="theme-color" style="background: #bdb2ff;"></div>
                            <div class="theme-color" style="background: #a0c4ff;"></div>
                            <div class="theme-color" style="background: #caffbf;"></div>
                        </div>
                        <div class="theme-name">Soft Pastel</div>
                    </div>
                </div>
            </div>

            <!-- Premium Themes Section -->
            <div class="settings-section">
                <label class="settings-label">Premium Themes</label>
                <div id="premiumThemesContainer">
                    <!-- Premium themes will be rendered dynamically by theme.js -->
                </div>
            </div>

            <!-- Features Section -->
            <div class="settings-section">
                <label class="settings-label">Features</label>
                <div class="features-menu">
                    <button class="feature-menu-btn" id="worldClockMenuBtn">
                        <span class="feature-icon">üåç</span>
                        <span class="feature-label">World Clock</span>
                    </button>
                    <button class="feature-menu-btn" id="stopwatchMenuBtn">
                        <span class="feature-icon">‚è±Ô∏è</span>
                        <span class="feature-label">Stopwatch</span>
                    </button>
                    <button class="feature-menu-btn" id="focusMenuBtn">
                        <span class="feature-icon">üéØ</span>
                        <span class="feature-label">Focus Mode</span>
                    </button>
                    <button class="feature-menu-btn" id="soundMenuBtn">
                        <span class="feature-icon">üéµ</span>
                        <span class="feature-label">Ambient Sounds</span>
                    </button>
                    <button class="feature-menu-btn" id="analyticsMenuBtn">
                        <span class="feature-icon">üìä</span>
                        <span class="feature-label">Analytics</span>
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <label class="settings-label">Time Format</label>
                <div class="format-toggle">
                    <button class="format-btn active" data-format="24h" aria-label="24-hour format">24h</button>
                    <button class="format-btn" data-format="12h" aria-label="12-hour format">12h</button>
                </div>
            </div>

            <div class="settings-section">
                <label class="settings-label">Animation Speed</label>
                <div class="speed-control">
                    <span class="speed-label">0.5x</span>
                    <input type="range" class="speed-slider" id="speedSlider" min="0.5" max="2" step="0.1" value="1" aria-label="Animation speed">
                    <span class="speed-label">2x</span>
                </div>
                <p class="speed-value" id="speedValue">1.0x</p>
            </div>

            <div class="settings-section">
                <label class="settings-label">Auto Theme</label>
                <div class="toggle-container">
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoThemeToggle" aria-label="Enable auto theme switching">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label" id="autoThemeLabel">Off</span>
                </div>
                <p class="auto-theme-hint">Automatically switch themes based on time of day</p>
            </div>

            <div class="settings-section">
                <label class="settings-label">Focus Stats üéØ</label>
                <div class="focus-stats-container" id="focusStatsContainer">
                    <div class="stat-item">
                        <div class="stat-value" id="todayFocusTime">0m</div>
                        <div class="stat-label">Today</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="weekFocusTime">0m</div>
                        <div class="stat-label">This Week</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="focusStreak">0</div>
                        <div class="stat-label">Day Streak üî•</div>
                    </div>
                </div>
                <p class="focus-stats-hint">Use Focus Mode (üéØ) to track your deep work sessions</p>
            </div>

            <div class="settings-section">
                <div class="recommendations-header">
                    <label class="settings-label">Theme Recommendations üé®</label>
                    <button class="refresh-recommendations-btn" id="refreshRecommendationsBtn" title="Refresh recommendations">
                        üîÑ
                    </button>
                </div>
                <div class="theme-recommendations-container" id="themeRecommendationsContainer">
                    <div class="recommendations-content" id="recommendationsContent">
                        <!-- Recommendations will be dynamically generated -->
                    </div>
                </div>
                <p class="recommendations-hint">AI-powered theme suggestions based on your usage patterns</p>
            </div>

            <div class="settings-section">
                <label class="settings-label">Circadian Insights üåô</label>
                <div class="circadian-insights-container" id="circadianInsightsContainer">
                    <div class="insight-grid">
                        <div class="insight-item">
                            <div class="insight-label">Peak Hours</div>
                            <div class="insight-value" id="peakHoursDisplay">Analyzing...</div>
                        </div>
                        <div class="insight-item">
                            <div class="insight-label">Best Focus Time</div>
                            <div class="insight-value" id="focusTimeDisplay">Analyzing...</div>
                        </div>
                        <div class="insight-item">
                            <div class="insight-label">Suggested Break</div>
                            <div class="insight-value" id="breakTimeDisplay">üîí Premium</div>
                        </div>
                        <div class="insight-item">
                            <div class="insight-label">Productivity</div>
                            <div class="insight-value" id="productivityScore">üîí Premium</div>
                        </div>
                    </div>
                    <div class="insights-premium-notice" id="insightsPremiumNotice">
                        <p class="premium-notice-text">üåü Unlock detailed circadian insights with Premium</p>
                        <button class="upgrade-insights-btn" id="upgradeInsightsBtn">
                            Upgrade for $4.99/year
                        </button>
                    </div>
                </div>
                <p class="insights-hint">Personalized insights based on your activity patterns</p>
            </div>

            <div class="settings-section">
                <label class="settings-label">Share Settings</label>
                <button class="share-url-btn" id="shareUrlBtn" aria-label="Copy shareable URL">
                    <span class="share-icon">üîó</span>
                    <span class="share-text">Copy URL</span>
                </button>
                <p class="share-hint">Share your current theme settings via URL</p>
            </div>
        </div>
    </div>

    <!-- Alarm Modal -->
    <div class="alarm-modal" id="alarmModal" role="dialog" aria-labelledby="alarmTitle" aria-modal="true">
        <div class="alarm-panel">
            <div class="alarm-header">
                <h2 class="alarm-title" id="alarmTitle">Alarms & Timers</h2>
                <button class="close-btn" id="alarmCloseBtn" aria-label="Close alarm">√ó</button>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-nav" role="tablist">
                <button class="tab-btn active" id="alarmTab" role="tab" aria-selected="true" aria-controls="alarmPanel">
                    Alarms
                </button>
                <button class="tab-btn" id="timerTab" role="tab" aria-selected="false" aria-controls="timerPanel">
                    Timer
                </button>
            </div>

            <!-- Alarm Panel -->
            <div class="tab-panel active" id="alarmPanel" role="tabpanel" aria-labelledby="alarmTab">
                <!-- Notification Permission -->
                <div class="notification-permission" id="notificationPermission" style="display: none;">
                    <p class="permission-text">‚ö†Ô∏è Enable notifications to receive alarm alerts</p>
                    <button class="permission-btn" id="enableNotificationBtn">Enable Notifications</button>
                </div>

                <!-- Alarm Time Picker -->
                <div class="time-picker">
                    <label class="picker-label">Set Alarm Time</label>
                    <div class="time-inputs">
                        <input type="number" class="time-input" id="alarmHour" min="0" max="23" placeholder="HH" aria-label="Hour">
                        <span class="time-separator">:</span>
                        <input type="number" class="time-input" id="alarmMinute" min="0" max="59" placeholder="MM" aria-label="Minute">
                        <span class="time-separator">:</span>
                        <input type="number" class="time-input" id="alarmSecond" min="0" max="59" placeholder="SS" aria-label="Second">
                    </div>

                    <!-- Repeat Options -->
                    <div class="repeat-options">
                        <label class="repeat-label">Repeat</label>
                        <select class="repeat-select" id="alarmRepeat" aria-label="Repeat option">
                            <option value="none">Once</option>
                            <option value="daily">Every Day</option>
                            <option value="weekdays">Weekdays (Mon-Fri)</option>
                            <option value="weekends">Weekends (Sat-Sun)</option>
                            <option value="custom">Custom Days...</option>
                        </select>
                    </div>

                    <!-- Custom Days Picker (hidden by default) -->
                    <div class="custom-days" id="customDays" style="display: none;">
                        <label class="repeat-label">Select Days</label>
                        <div class="days-grid">
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="0">
                                <span>Sun</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="1">
                                <span>Mon</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="2">
                                <span>Tue</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="3">
                                <span>Wed</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="4">
                                <span>Thu</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="5">
                                <span>Fri</span>
                            </label>
                            <label class="day-checkbox">
                                <input type="checkbox" name="day" value="6">
                                <span>Sat</span>
                            </label>
                        </div>
                    </div>

                    <!-- Custom Wake-up Message -->
                    <div class="alarm-field">
                        <label class="picker-label">Wake-up Message üíå</label>
                        <div class="message-selector">
                            <select class="message-select" id="messageSelect">
                                <option value="default">Default Alarm</option>
                                <option value="record-new">+ Record New Message</option>
                            </select>
                        </div>
                        <p class="message-hint">Wake up to a message from someone you love</p>
                    </div>

                    <button class="add-alarm-btn" id="addAlarmBtn">+ Add Alarm</button>
                </div>

                <!-- Alarm List -->
                <div class="alarm-list" id="alarmList">
                    <p class="empty-state" id="emptyAlarmState">No alarms set</p>
                </div>
            </div>

            <!-- Timer Panel -->
            <div class="tab-panel" id="timerPanel" role="tabpanel" aria-labelledby="timerTab" hidden>
                <!-- Timer Input -->
                <div class="timer-input-section">
                    <label class="picker-label">Set Timer Duration</label>
                    <div class="time-inputs">
                        <input type="number" class="time-input" id="timerHour" min="0" max="23" placeholder="HH" aria-label="Hours">
                        <span class="time-separator">:</span>
                        <input type="number" class="time-input" id="timerMinute" min="0" max="59" placeholder="MM" aria-label="Minutes">
                        <span class="time-separator">:</span>
                        <input type="number" class="time-input" id="timerSecond" min="0" max="59" placeholder="SS" aria-label="Seconds">
                    </div>
                </div>

                <!-- Timer Controls -->
                <div class="timer-controls">
                    <button class="timer-btn start-btn" id="startTimerBtn">Start Timer</button>
                    <button class="timer-btn reset-btn" id="resetTimerBtn" disabled>Reset</button>
                </div>

                <!-- Timer Display -->
                <div class="timer-display" id="timerDisplay">
                    <div class="timer-time">00:00:00</div>
                    <div class="timer-progress">
                        <div class="timer-progress-bar" id="timerProgressBar"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- World Clock Modal -->
    <div class="world-clock-modal" id="worldClockModal" role="dialog" aria-labelledby="worldClockTitle" aria-modal="true">
        <div class="world-clock-panel">
            <div class="world-clock-header">
                <h2 class="world-clock-title" id="worldClockTitle">World Clocks</h2>
                <button class="close-btn" id="worldClockCloseBtn" aria-label="Close world clock">√ó</button>
            </div>

            <!-- Add City Section -->
            <div class="add-city-section">
                <label class="picker-label">Add City</label>
                <div class="city-picker">
                    <select class="city-select" id="citySelect" aria-label="Select city">
                        <option value="">Choose a city...</option>
                    </select>
                    <button class="add-city-btn" id="addCityBtn">+ Add City</button>
                </div>
            </div>

            <!-- Time Zone Converter -->
            <div class="timezone-converter-section">
                <label class="picker-label">Time Zone Converter üåç</label>
                <div class="converter-inputs">
                    <div class="converter-input-group">
                        <label class="converter-label">From</label>
                        <select class="converter-select" id="converterFromCity">
                            <option value="">Choose city...</option>
                        </select>
                        <input type="time" class="converter-time-input" id="converterTime" value="12:00">
                    </div>
                    <div class="converter-arrow">‚Üí</div>
                    <div class="converter-input-group">
                        <label class="converter-label">To</label>
                        <select class="converter-select" id="converterToCity">
                            <option value="">Choose city...</option>
                        </select>
                        <div class="converted-time" id="convertedTime">--:--</div>
                    </div>
                </div>
                <div class="converter-hint">Convert times between time zones</div>
            </div>

            <!-- Meeting Time Finder -->
            <div class="meeting-finder-section">
                <label class="picker-label">Meeting Time Finder üìÖ</label>
                <div class="meeting-cities-selector">
                    <select class="meeting-city-select" id="meetingCitySelect">
                        <option value="">Add participating city...</option>
                    </select>
                    <button class="add-meeting-city-btn" id="addMeetingCityBtn">+ Add</button>
                </div>
                <div class="meeting-cities-list" id="meetingCitiesList">
                    <p class="empty-meeting-state">Add cities to find optimal meeting times</p>
                </div>
                <div class="meeting-suggestions" id="meetingSuggestions" style="display: none;">
                    <div class="suggestions-title">Best Meeting Times:</div>
                    <div class="suggestions-list" id="suggestionsList"></div>
                </div>
            </div>

            <!-- World Clock List -->
            <div class="world-clock-list" id="worldClockList">
                <p class="empty-state" id="emptyWorldClockState">No cities added</p>
            </div>
        </div>
    </div>

    <!-- Custom Message Modal -->
    <div class="message-modal" id="messageModal" role="dialog" aria-labelledby="messageTitle" aria-modal="true">
        <div class="message-panel">
            <div class="message-header">
                <h2 class="message-title" id="messageTitle">Custom Wake-up Message üíå</h2>
                <button class="close-btn" id="messageCloseBtn" aria-label="Close">√ó</button>
            </div>

            <!-- Record Section -->
            <div class="record-section">
                <h3 class="section-subtitle">Record Message</h3>
                <div class="record-controls">
                    <button class="record-btn" id="recordBtn">
                        <span class="btn-icon">üé§</span>
                        <span class="btn-text">Start Recording</span>
                    </button>
                    <button class="stop-record-btn" id="stopRecordBtn" disabled>
                        <span class="btn-icon">‚èπ</span>
                        <span class="btn-text">Stop</span>
                    </button>
                </div>
                <div class="recording-indicator" id="recordingIndicator" style="display: none;">
                    <span class="recording-dot"></span>
                    <span class="recording-time" id="recordingTime">00:00</span>
                </div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section" id="previewSection" style="display: none;">
                <h3 class="section-subtitle">Preview</h3>
                <audio class="audio-preview" id="audioPreview" controls></audio>
                <div class="preview-controls">
                    <button class="save-message-btn" id="saveMessageBtn">
                        <span class="btn-icon">üíæ</span>
                        <span class="btn-text">Save Message</span>
                    </button>
                    <button class="discard-btn" id="discardBtn">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">Discard</span>
                    </button>
                </div>
            </div>

            <!-- My Messages List -->
            <div class="messages-list-section">
                <h3 class="section-subtitle">My Messages</h3>
                <div class="messages-list" id="messagesList">
                    <p class="empty-state">No messages yet. Record your first one!</p>
                </div>
            </div>

            <!-- Premium Upsell (if free tier) -->
            <div class="message-premium-notice" id="messagePremiumNotice" style="display: none;">
                <p class="premium-text">
                    üîí Free users can save 1 message. Upgrade to Premium for unlimited messages!
                </p>
                <button class="premium-upgrade-btn" id="messageUpgradeBtn">
                    Upgrade to Premium - $1.99
                </button>
            </div>
        </div>
    </div>

    <!-- Ambient Sound Modal -->
    <div class="sound-modal" id="soundModal" role="dialog" aria-labelledby="soundTitle" aria-modal="true">
        <div class="sound-panel">
            <div class="sound-header">
                <h2 class="sound-title" id="soundTitle">Ambient Sounds üéµ</h2>
                <button class="close-btn" id="soundCloseBtn" aria-label="Close sounds">√ó</button>
            </div>

            <!-- Sound Categories -->
            <div class="sound-categories">
                <!-- Lofi Beats -->
                <div class="sound-category">
                    <h3 class="category-title">Lofi Beats</h3>
                    <div class="sound-grid">
                        <div class="sound-card" data-sound="lofi-chill">
                            <div class="sound-icon">üé∏</div>
                            <div class="sound-name">Chill Lofi</div>
                            <button class="sound-play-btn" data-sound="lofi-chill">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="lofi-jazzy">
                            <div class="sound-icon">üéπ</div>
                            <div class="sound-name">Jazzy Lofi</div>
                            <button class="sound-play-btn" data-sound="lofi-jazzy">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="lofi-ambient">
                            <div class="sound-icon">üåå</div>
                            <div class="sound-name">Ambient Lofi</div>
                            <button class="sound-play-btn" data-sound="lofi-ambient">‚ñ∂</button>
                        </div>
                    </div>
                </div>

                <!-- Nature Sounds -->
                <div class="sound-category">
                    <h3 class="category-title">Nature</h3>
                    <div class="sound-grid">
                        <div class="sound-card" data-sound="rain">
                            <div class="sound-icon">üåßÔ∏è</div>
                            <div class="sound-name">Rain</div>
                            <button class="sound-play-btn" data-sound="rain">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="ocean">
                            <div class="sound-icon">üåä</div>
                            <div class="sound-name">Ocean Waves</div>
                            <button class="sound-play-btn" data-sound="ocean">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="forest">
                            <div class="sound-icon">üå≤</div>
                            <div class="sound-name">Forest</div>
                            <button class="sound-play-btn" data-sound="forest">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="fire">
                            <div class="sound-icon">üî•</div>
                            <div class="sound-name">Fireplace</div>
                            <button class="sound-play-btn" data-sound="fire">‚ñ∂</button>
                        </div>
                    </div>
                </div>

                <!-- White Noise -->
                <div class="sound-category">
                    <h3 class="category-title">White Noise</h3>
                    <div class="sound-grid">
                        <div class="sound-card" data-sound="white-noise">
                            <div class="sound-icon">üìª</div>
                            <div class="sound-name">White Noise</div>
                            <button class="sound-play-btn" data-sound="white-noise">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="brown-noise">
                            <div class="sound-icon">üéöÔ∏è</div>
                            <div class="sound-name">Brown Noise</div>
                            <button class="sound-play-btn" data-sound="brown-noise">‚ñ∂</button>
                        </div>
                        <div class="sound-card" data-sound="pink-noise">
                            <div class="sound-icon">üå∏</div>
                            <div class="sound-name">Pink Noise</div>
                            <button class="sound-play-btn" data-sound="pink-noise">‚ñ∂</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Volume Control -->
            <div class="sound-controls">
                <label class="volume-label">Volume</label>
                <div class="volume-control">
                    <span class="volume-icon">üîà</span>
                    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50" aria-label="Volume">
                    <span class="volume-icon">üîä</span>
                </div>
                <div class="volume-value" id="volumeValue">50%</div>
            </div>

            <!-- Currently Playing -->
            <div class="now-playing" id="nowPlaying" style="display: none;">
                <div class="now-playing-info">
                    <span class="now-playing-label">Now Playing:</span>
                    <span class="now-playing-name" id="nowPlayingName">-</span>
                </div>
                <button class="stop-btn" id="stopBtn">‚èπ Stop</button>
            </div>
        </div>
    </div>

    <!-- Stopwatch Modal -->
    <div class="stopwatch-modal" id="stopwatchModal" role="dialog" aria-labelledby="stopwatchTitle" aria-modal="true">
        <div class="stopwatch-panel">
            <div class="stopwatch-header">
                <h2 class="stopwatch-title" id="stopwatchTitle">Stopwatch</h2>
                <button class="close-btn" id="stopwatchCloseBtn" aria-label="Close stopwatch">√ó</button>
            </div>

            <!-- Stopwatch Display -->
            <div class="stopwatch-display">
                <div class="stopwatch-time" id="stopwatchTime">00:00:00.000</div>
            </div>

            <!-- Stopwatch Controls -->
            <div class="stopwatch-controls">
                <button class="stopwatch-control-btn start-btn" id="stopwatchStartBtn">
                    <span class="btn-icon">‚ñ∂</span>
                    <span class="btn-text">Start</span>
                </button>
                <button class="stopwatch-control-btn lap-btn" id="stopwatchLapBtn" disabled>
                    <span class="btn-icon">‚è±</span>
                    <span class="btn-text">Lap</span>
                </button>
                <button class="stopwatch-control-btn reset-btn" id="stopwatchResetBtn" disabled>
                    <span class="btn-icon">‚Üª</span>
                    <span class="btn-text">Reset</span>
                </button>
            </div>

            <!-- Lap Times List -->
            <div class="lap-times-section">
                <h3 class="lap-times-title">Lap Times</h3>
                <div class="lap-times-list" id="lapTimesList">
                    <p class="empty-state" id="emptyLapState">No laps recorded</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="clock-wrapper">
            <!-- SVG Rings -->
            <svg class="rings" viewBox="0 0 400 400">
                <defs>
                    <!-- Gradient definitions -->
                    <linearGradient id="hourGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="minuteGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="secondGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="msGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#43e97b;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#38f9d7;stop-opacity:1" />
                    </linearGradient>
                </defs>

                <!-- Ring backgrounds -->
                <circle class="ring-bg" cx="200" cy="200" r="180" />
                <circle class="ring-bg" cx="200" cy="200" r="140" />
                <circle class="ring-bg" cx="200" cy="200" r="100" />
                <circle class="ring-bg" cx="200" cy="200" r="60" />

                <!-- Arc segments (dynamically generated by JS) -->
                <g id="hourArcs"></g>
                <g id="minuteArcs"></g>
                <g id="secondArcs"></g>
                <g id="msArcs"></g>

                <!-- Alarm markers (dynamically generated by JS) -->
                <g id="alarmMarkers"></g>
            </svg>

            <!-- Time labels -->
            <div class="time-labels">
                <div class="time-unit">
                    <span class="time-value" id="hourValue">00</span>
                    <span class="time-label">Hours</span>
                </div>
                <div class="time-unit">
                    <span class="time-value" id="minuteValue">00</span>
                    <span class="time-label">Minutes</span>
                </div>
                <div class="time-unit">
                    <span class="time-value" id="secondValue">00</span>
                    <span class="time-label">Seconds</span>
                </div>
                <div class="time-unit">
                    <span class="time-value" id="msValue">000</span>
                    <span class="time-label">Milliseconds</span>
                </div>
            </div>

            <!-- Accessible text time display -->
            <div class="text-time" aria-live="polite" aria-atomic="true">
                <span id="textTime">00:00:00.000</span>
            </div>

            <!-- Time-based Greeting -->
            <div class="greeting-container" id="greetingContainer">
                <span class="greeting-text" id="greetingText">Good morning</span>
                <span class="greeting-emoji" id="greetingEmoji">üåÖ</span>
            </div>

            <!-- Streak Counter -->
            <div class="streak-container" id="streakContainer" style="display: none;">
                <span class="streak-fire">üî•</span>
                <span class="streak-number" id="streakNumber">0</span>
                <span class="streak-label">day streak</span>
            </div>

            <!-- Focus Mode Session Info -->
            <div class="focus-session-info" id="focusSessionInfo" style="display: none;">
                <div class="focus-timer" id="focusTimer">00:00</div>
                <div class="focus-label">Focus Session</div>
            </div>
        </div>
    </div>

    <!-- Analytics Dashboard Modal -->
    <div class="analytics-dashboard-modal" id="analyticsDashboardModal" role="dialog" aria-labelledby="analyticsDashboardTitle" aria-modal="true">
        <div class="analytics-dashboard-content">
            <div class="analytics-dashboard-header">
                <h2 id="analyticsDashboardTitle">Analytics Dashboard</h2>
                <button class="modal-close-btn" id="analyticsDashboardCloseBtn" aria-label="Close analytics dashboard">√ó</button>
            </div>

            <div class="analytics-dashboard-body">
                <!-- Overview Stats -->
                <div class="analytics-section">
                    <h3 class="section-title">Overview</h3>
                    <div class="stats-grid" id="overviewStatsContainer">
                        <!-- Stats will be rendered here -->
                    </div>
                </div>

                <!-- Conversion Funnel -->
                <div class="analytics-section">
                    <h3 class="section-title">Conversion Funnel</h3>
                    <div class="funnel-container" id="conversionFunnelContainer">
                        <!-- Funnel will be rendered here -->
                    </div>
                </div>

                <!-- Event Timeline -->
                <div class="analytics-section">
                    <h3 class="section-title">Recent Events</h3>
                    <div class="event-timeline" id="eventTimelineContainer">
                        <!-- Events will be rendered here -->
                    </div>
                </div>

                <!-- Session Stats -->
                <div class="analytics-section">
                    <h3 class="section-title">Recent Sessions</h3>
                    <div class="sessions-container" id="sessionStatsContainer">
                        <!-- Sessions will be rendered here -->
                    </div>
                </div>

                <!-- Export Controls -->
                <div class="analytics-section">
                    <h3 class="section-title">Data Management</h3>
                    <div class="analytics-controls">
                        <button class="analytics-control-btn export-btn" onclick="exportAnalyticsData()">
                            üì• Export Data
                        </button>
                        <button class="analytics-control-btn clear-btn" onclick="clearAnalyticsData()">
                            üóëÔ∏è Clear Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Module Scripts (load in dependency order) -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/auto-theme.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/analytics-dashboard.js"></script>
    <script src="js/payment.js"></script>
    <script src="js/clock.js"></script>
    <script src="js/greeting.js"></script>
    <script src="js/focus.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/streak.js"></script>
    <script src="js/custom-message.js"></script>
    <script src="js/theme-recommendations.js"></script>
    <script src="js/circadian-insights.js"></script>
    <script src="js/fullscreen.js"></script>
    <script src="js/pwa.js"></script>
    <script src="js/alarm.js"></script>
    <script src="js/world-clock.js"></script>
    <script src="js/stopwatch.js"></script>

    <!-- Main initialization -->
    <script src="main.js"></script>
</body>
</html>
